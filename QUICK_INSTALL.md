# 🚀 Быстрая установка TelegrammBolt

## ⚡ Одна команда для полной установки

### Ubuntu/Debian:
```bash
curl -fsSL https://raw.githubusercontent.com/Nickto55/TelegrammBolt/main/install.sh | sudo bash
```

### Или скачать и запустить:
```bash
wget https://raw.githubusercontent.com/Nickto55/TelegrammBolt/main/install.sh
chmod +x install.sh
sudo ./install.sh
```

---

## 📋 Что делает установщик

### Автоматически:
✅ Проверяет систему (Ubuntu/Debian)  
✅ Проверяет Python (3.9+)  
✅ Устанавливает зависимости  
✅ Создает пользователя `telegrambot`  
✅ Клонирует репозиторий в `/opt/telegrambot`  
✅ Создает виртуальное окружение  
✅ Устанавливает Python пакеты  
✅ Настраивает systemd службу  
✅ Устанавливает и настраивает Nginx (если выбран веб)  
✅ Получает SSL сертификат (если выбран HTTPS)  

### Интерактивно спросит:
1. **🤖 Токен бота** - получите у @BotFather
2. **👨‍💼 ID администратора(ов)** - узнайте у @userinfobot
3. **📧 Настройки Email (SMTP)** - опционально, для отправки отчетов
4. **🌐 Веб-интерфейс** - включить или нет
5. **🔒 HTTPS** - настроить Let's Encrypt (требуется домен)

---

## 🎯 Пример интерактивной установки

```
═══════════════════════════════════════════════
  Настройка Telegram Бота
═══════════════════════════════════════════════

[INFO] Для работы бота нужен токен от @BotFather
[INFO] Как получить токен:
  1. Откройте Telegram
  2. Найдите @BotFather
  3. Отправьте команду: /newbot
  4. Следуйте инструкциям
  5. Скопируйте токен

[?] Введите токен бота: 123456789:ABCdefGHIjklMNOpqrsTUVwxyz
[✓] Токен принят

[?] Введите ID администратора(ов) через запятую: 123456789
[✓] ID администраторов: 123456789

═══════════════════════════════════════════════
  Настройка Email (опционально)
═══════════════════════════════════════════════

[?] Настроить Email? (y/n): n
[INFO] SMTP пропущен. Можно настроить позже

═══════════════════════════════════════════════
  Настройка веб-интерфейса
═══════════════════════════════════════════════

[?] Включить веб-интерфейс? (Y/n): Y
Порт для веб-интерфейса (по умолчанию 5000): 5000
[✓] Веб-интерфейс будет доступен на порту 5000

[?] Настроить HTTPS с Let's Encrypt? (y/N): n
```

---

## 📁 После установки

### Структура файлов:
```
/opt/telegrambot/
├── bot.py                    # Главный файл
├── data/                     # Данные и конфиги
│   ├── ven_bot.json         # Конфиг бота (создан автоматически)
│   ├── smtp_config.json     # SMTP конфиг (если настроен)
│   ├── bot_data.json        # Данные бота
│   ├── users_data.json      # Данные пользователей
│   └── photos/              # Фотографии из заявок
├── .venv/                    # Виртуальное окружение
└── ...
```

### Управление ботом:
```bash
# Запустить
sudo systemctl start telegrambot

# Остановить
sudo systemctl stop telegrambot

# Перезапустить
sudo systemctl restart telegrambot

# Статус
sudo systemctl status telegrambot

# Логи (живые)
sudo journalctl -u telegrambot -f

# Логи (последние 100 строк)
sudo journalctl -u telegrambot -n 100
```

---

## 🌐 Доступ к веб-интерфейсу

### Без HTTPS:
```
http://ВАШ_IP:5000
```

### С HTTPS:
```
https://ваш-домен.ru
```

### Авторизация:
Авторизация происходит через Telegram Widget

---

## 🔧 Ручная настройка после установки

### Редактировать конфиг бота:
```bash
sudo nano /opt/telegrambot/data/ven_bot.json
```

### Редактировать SMTP:
```bash
sudo nano /opt/telegrambot/data/smtp_config.json
```

### После изменений - перезапустить:
```bash
sudo systemctl restart telegrambot
```

---

## 🐳 Установка в Docker

Для Docker используйте специальную переменную:
```bash
export SKIP_SERVICE=1
./install.sh
```

Затем запустите вручную:
```bash
cd /opt/telegrambot
.venv/bin/python bot.py
```

---

## 🆘 Проблемы?

### Логи не показывают ошибок:
```bash
# Прямой запуск для отладки
cd /opt/telegrambot
sudo -u telegrambot .venv/bin/python bot.py
```

### Бот не отвечает:
1. Проверьте токен в `data/ven_bot.json`
2. Проверьте интернет-соединение
3. Проверьте логи: `journalctl -u telegrambot -f`

### Веб-интерфейс не открывается:
1. Проверьте статус Nginx: `systemctl status nginx`
2. Проверьте порт: `netstat -tulpn | grep :5000`
3. Проверьте firewall: `sudo ufw status`

### Python 3.13 ошибки:
См. `docs/TROUBLESHOOTING.md` → раздел "Python 3.13"

---

## 📚 Дополнительные ресурсы

- **Полное руководство:** `docs/INSTALLATION.md`
- **Решение проблем:** `docs/TROUBLESHOOTING.md`
- **Шпаргалка команд:** `docs/CHEATSHEET.md`
- **Настройка HTTPS:** `docs/HTTPS_SETUP.md`

---

## ✨ Особенности установщика v2.0

- ✅ **Полностью интерактивный** - задает все нужные вопросы
- ✅ **Умная проверка** - проверяет систему и Python
- ✅ **Автоматическая настройка** - создает все конфиги
- ✅ **Красивый интерфейс** - цветной вывод и прогресс
- ✅ **Безопасность** - правильные права на файлы
- ✅ **Веб и HTTPS** - опциональная настройка
- ✅ **Docker поддержка** - работает в контейнерах
- ✅ **Откат при ошибках** - безопасная установка

---

## 🎉 Готово!

После установки бот будет:
- ✅ Запущен как служба
- ✅ Автоматически стартовать при загрузке
- ✅ Перезапускаться при сбоях
- ✅ Логировать все действия

**Найдите своего бота в Telegram и отправьте `/start`**

---

**Автор:** Nickto55  
**Версия:** 2.0  
**Дата:** 17 октября 2025
