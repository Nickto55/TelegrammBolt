# Telegram Bot - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –î–°–ï

Telegram –±–æ—Ç —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É—á–µ—Ç–∞.

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **–û–°**: Debian 10+ –∏–ª–∏ Ubuntu 18.04+
- **Python**: 3.8+
- **–ü–∞–º—è—Ç—å**: –º–∏–Ω–∏–º—É–º 512 MB RAM
- **–ú–µ—Å—Ç–æ**: ~200 MB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
```bash
git clone <your-repo-url>
cd TelegrammBolt
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```bash
chmod +x setup.sh
./setup.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–±–Ω–æ–≤–∏—Ç —Å–∏—Å—Ç–µ–º—É
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Python, Nginx, Certbot)
- –°–æ–∑–¥–∞—Å—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç Python –ø–∞–∫–µ—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–ø–æ–ø—Ä–æ—Å–∏—Ç –≤–≤–µ—Å—Ç–∏ —Ç–æ–∫–µ–Ω—ã)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –¥–æ–º–µ–Ω –∏ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –°–æ–∑–¥–∞—Å—Ç systemd —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 3. –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
- `BOT_TOKEN` - –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç [@BotFather](https://t.me/BotFather) –≤ Telegram
- `ADMIN_ID` - –≤–∞—à Telegram ID (—É–∑–Ω–∞–π—Ç–µ —É [@userinfobot](https://t.me/userinfobot))
- `BOT_USERNAME` - –∏–º—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –±–µ–∑ @

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–¥–ª—è email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π):**
- SMTP —Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, Gmail)
- Email –∏ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
./manage.sh
```

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –≤ —Å—Ç–∏–ª–µ X-UI —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:
- üöÄ –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞/–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìù –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
- üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
- ‚öôÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ systemd (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)
```bash
# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl start telegrambot
sudo systemctl start telegramweb

# –î–æ–±–∞–≤–∏—Ç—å –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É
sudo systemctl enable telegrambot
sudo systemctl enable telegramweb

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status telegrambot
sudo systemctl status telegramweb
```

### –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å–∫—Ä–∏–ø—Ç–æ–≤:

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä
```bash
./start.sh
```
–í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å: –±–æ—Ç, –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –æ–±–∞.

### –¢–æ–ª—å–∫–æ Telegram –±–æ—Ç
```bash
./start_bot.sh
```

### –¢–æ–ª—å–∫–æ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```bash
### config/domain.conf (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω SSL)
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–º–µ–Ω–∞ –∏ SSL:
```bash
DOMAIN=bot.example.com
SSL_EMAIL=admin@example.com
WEB_PORT=5000
SSL_ENABLED=true
```

## SSL –∏ –î–æ–º–µ–Ω

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "Permission denied"
```bash
chmod +x setup.sh manage.sh
```

### –ü–æ—Ä—Ç 5000 –∏–ª–∏ 80 –∑–∞–Ω—è—Ç
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç:
```bash
sudo lsof -ti:5000 | xargs kill -9  # –î–ª—è –ø–æ—Ä—Ç–∞ 5000
sudo lsof -ti:80 | xargs kill -9    # –î–ª—è –ø–æ—Ä—Ç–∞ 80
```

### SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –¥–æ–º–µ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤–∞—à IP
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ—Ä—Ç—ã 80 –∏ 443 –æ—Ç–∫—Ä—ã—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall: `sudo ufw allow 80,443/tcp`

### –°–µ—Ä–≤–∏—Å—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
sudo journalctl -u telegrambot -n 50
sudo journalctl -u telegramweb -n 50
```

### Python –≤–µ—Ä—Å–∏—è < 3.8
–û–±–Ω–æ–≤–∏—Ç–µ Python:
```bash
sudo apt update
sudo apt install python3.10
```

## –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# –ß–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
./manage.sh  # –í—ã–±–µ—Ä–∏—Ç–µ "6. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤"

# –ù–∞–ø—Ä—è–º—É—é
sudo journalctl -u telegrambot -f    # Live –ª–æ–≥–∏ –±–æ—Ç–∞
sudo journalctl -u telegramweb -f    # Live –ª–æ–≥–∏ –≤–µ–±
tail -f /var/log/nginx/access.log    # –õ–æ–≥–∏ nginx
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ß–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
./manage.sh  # –í—ã–±–µ—Ä–∏—Ç–µ "11. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ"

# –í—Ä—É—á–Ω—É—é
tar -czf backup_$(date +%Y%m%d).tar.gz config/ data/
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```bash
git pull
source venv/bin/activate
pip install -r requirements.txt --upgrade
sudo systemctl restart telegrambot telegramweb
``` config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ data/             # –î–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ç–æ
‚îú‚îÄ‚îÄ setup.sh          # –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏
‚îú‚îÄ‚îÄ start.sh          # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ requirements.txt  # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### config/ven_bot.json
–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞:
```json
{
  "BOT_TOKEN": "your_bot_token",
  "ADMIN_IDS": ["your_telegram_id"],
  "BOT_USERNAME": "your_bot_username"
}
```

### config/smtp_config.json (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ email:
```json
{
  "SMTP_SERVER": "smtp.gmail.com",
  "SMTP_PORT": 587,
  "SMTP_USER": "your_email@gmail.com",
  "SMTP_PASSWORD": "your_app_password",
  "FROM_NAME": "Bot Name"
}
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –û—à–∏–±–∫–∞: "Permission denied"
```bash
chmod +x setup.sh
```

### –ü–æ—Ä—Ç 5000 –∑–∞–Ω—è—Ç
–ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ `web/web_app.py` –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å:
```bash
sudo lsof -ti:5000 | xargs kill -9
```

### Python –≤–µ—Ä—Å–∏—è < 3.8
–û–±–Ω–æ–≤–∏—Ç–µ Python:
```bash
sudo apt update
sudo apt install python3.10
```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –í–µ—Ä—Å–∏—é –û–°: `lsb_release -a`
2. –í–µ—Ä—Å–∏—é Python: `python3 --version`
3. –ù–∞–ª–∏—á–∏–µ sudo –ø—Ä–∞–≤
4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ DNS –∏ SSL

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
chmod +x check-dns.sh
./check-dns.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç –∏ –ø–æ–∫–∞–∂–µ—Ç:
- ‚úÖ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ DNS —Ä–µ–∑–æ–ª–≤–∏–Ω–≥ –¥–æ–º–µ–Ω–∞ (–ª–æ–∫–∞–ª—å–Ω–æ –∏ —á–µ—Ä–µ–∑ Google/Cloudflare DNS)
- ‚úÖ –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ IP —Å–µ—Ä–≤–µ—Ä–∞ –∏ –¥–æ–º–µ–Ω–∞
- ‚úÖ –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã (80, 443)
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ firewall
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å HTTP/HTTPS
- üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º—ã —Å DuckDNS

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ DuckDNS (*.duckdns.org):

1. **–û–±–Ω–æ–≤–∏—Ç–µ IP –∞–¥—Ä–µ—Å:**
   ```bash
   # –£–∑–Ω–∞–π—Ç–µ —Ç–µ–∫—É—â–∏–π IP
   curl ifconfig.me
   
   # –û–±–Ω–æ–≤–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª–∏ DuckDNS –∏–ª–∏ —á–µ—Ä–µ–∑ API
   curl "https://www.duckdns.org/update?domains=–≤–∞—à_–ø–æ–¥–¥–æ–º–µ–Ω&token=–≤–∞—à_—Ç–æ–∫–µ–Ω&ip="
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ DNS:**
   ```bash
   dig +short –≤–∞—à_–¥–æ–º–µ–Ω.duckdns.org
   # –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   ```

3. **–ï—Å–ª–∏ DNS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - —Å–º. –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é:
   ```bash
   cat SSL_TROUBLESHOOTING.md
   ```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã SSL

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

**Standalone —Ä–µ–∂–∏–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è DuckDNS):**
```bash
sudo systemctl stop nginx
sudo certbot certonly --standalone -d –≤–∞—à_–¥–æ–º–µ–Ω.com
sudo systemctl start nginx
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–µ–∑ SSL (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):**
```bash
# –î–æ—Å—Ç—É–ø –ø–æ HTTP –±–µ–∑ HTTPS
http://–≤–∞—à_–¥–æ–º–µ–Ω.com
# –∏–ª–∏ –ø–æ IP
http://–≤–∞—à_IP:5000
```

–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: **SSL_TROUBLESHOOTING.md**

---

**–í–∞–∂–Ω–æ**: –•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏ –ø–∞—Ä–æ–ª–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ `config/` –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö.
