🔥 ЭКСТРЕННАЯ ПОМОЩЬ - ЧТО СЛОМАЛОСЬ? 🔥

═══════════════════════════════════════════════════════════

ШАГ 1: ПОДКЛЮЧИТЕСЬ К СЕРВЕРУ
═══════════════════════════════════════════════════════════

ssh root@87.120.166.213
cd /root/TelegrammBolt


═══════════════════════════════════════════════════════════
ШАГ 2: ЗАПУСТИТЕ ЭКСТРЕННУЮ ДИАГНОСТИКУ
═══════════════════════════════════════════════════════════

python3 emergency_check.py

Скрипт покажет:
  ✓ Существует ли заявка 'Hshd'
  ✓ Есть ли ошибки в логах
  ✓ Работает ли config.py
  ✓ Запущен ли веб-сервер
  ✓ Установлены ли зависимости


═══════════════════════════════════════════════════════════
ШАГ 3: БЫСТРЫЕ ПРОВЕРКИ
═══════════════════════════════════════════════════════════

# Посмотреть последние 20 строк лога
tail -20 web.log

# Только ошибки
tail -100 web.log | grep -i error

# Проверить процессы
ps aux | grep web_app

# Проверить systemd
sudo systemctl status boltweb


═══════════════════════════════════════════════════════════
ШАГ 4: ТИПИЧНЫЕ ПРИЧИНЫ
═══════════════════════════════════════════════════════════

1. ЗАЯВКА НЕ СУЩЕСТВУЕТ
   → ID 'Hshd' может не существовать в базе
   → Проверьте: python3 check_dse_id.py Hshd
   → Попробуйте другую заявку

2. СЕРВЕР УПАЛ
   → Проверьте: ps aux | grep web_app
   → Перезапустите: bash restart_web.sh

3. ФАЙЛ ДАННЫХ ПОВРЕЖДЕН
   → Проверьте: python3 diagnose_dse.py
   → Проверьте права: ls -la bot_data.json

4. ОБНОВЛЕНИЕ КОДА
   → Может быть конфликт версий
   → Проверьте git: git status
   → Откатите: git checkout web_app.py

5. ЗАВИСИМОСТИ
   → Проверьте: pip3 list
   → Переустановите: pip3 install -r requirements.txt


═══════════════════════════════════════════════════════════
БЫСТРЫЕ РЕШЕНИЯ
═══════════════════════════════════════════════════════════

Проблема: 500 Internal Server Error
Решение:
  tail -50 web.log | grep ERROR
  bash restart_web.sh

Проблема: Сервер не отвечает
Решение:
  pkill -f web_app.py
  bash restart_web.sh

Проблема: Заявка не найдена
Решение:
  python3 check_dse_id.py Hshd
  # Используйте правильный ID из списка

Проблема: Работало, потом перестало
Решение:
  # Посмотрите, что изменилось
  git log -5
  git diff
  
  # Откатите изменения если нужно
  git checkout HEAD -- web_app.py
  bash restart_web.sh


═══════════════════════════════════════════════════════════
ЧТО МОГЛО СЛОМАТЬСЯ?
═══════════════════════════════════════════════════════════

✓ Обновление кода (git pull)
✓ Изменение конфигурации (config.py)
✓ Повреждение данных (bot_data.json)
✓ Падение сервера (out of memory, crash)
✓ Обновление зависимостей (pip install)
✓ Изменение прав доступа (chmod)
✓ Нехватка места на диске (df -h)
✓ Ошибка в логике кода (новая функция)


═══════════════════════════════════════════════════════════
КОМАНДЫ ДЛЯ ОТПРАВКИ НА СЕРВЕР
═══════════════════════════════════════════════════════════

# Отправить emergency_check.py
scp emergency_check.py root@87.120.166.213:/root/TelegrammBolt/

# Отправить все исправления
scp web_app.py server_check.py check_dse_id.py diagnose_dse.py \
    clear_logs.py restart_web.sh fix_server.sh quick_fix.sh \
    root@87.120.166.213:/root/TelegrammBolt/


═══════════════════════════════════════════════════════════
✅ НАЧНИТЕ С ЭТОГО:
═══════════════════════════════════════════════════════════

1. Отправьте emergency_check.py на сервер
2. Запустите: python3 emergency_check.py
3. Следуйте рекомендациям в выводе
4. Перезапустите: bash restart_web.sh

═══════════════════════════════════════════════════════════
